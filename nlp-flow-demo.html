<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CivicAI - NLP Flow Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #0a0a0a;
            color: #e7e7e7;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            width: 100%;
        }

        /* Landing Page */
        .landing-page {
            text-align: center;
            animation: fadeIn 0.5s ease-in;
        }

        .landing-page h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #e7e7e7;
            font-weight: 500;
            letter-spacing: -0.02em;
        }

        .landing-page p {
            font-size: 1rem;
            color: #888;
            margin-bottom: 2rem;
            font-weight: 400;
        }

        .input-container {
            background: #151515;
            border: 1px solid #1a1a1a;
            border-radius: 12px;
            padding: 1.5rem;
            transition: border-color 0.3s ease;
        }

        .input-container:focus-within {
            border-color: #2a2a2a;
        }

        .input-container input {
            width: 100%;
            padding: 1rem;
            border: 1px solid #1a1a1a;
            border-radius: 8px;
            background: #0a0a0a;
            color: #e7e7e7;
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .input-container input:focus {
            border-color: #2a2a2a;
        }

        .input-container input::placeholder {
            color: #666;
        }

        .input-container button {
            width: 100%;
            margin-top: 1rem;
            padding: 1rem;
            background: #e7e7e7;
            border: none;
            border-radius: 8px;
            color: #0a0a0a;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .input-container button:hover {
            background: #fff;
        }

        .input-container button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Loader Page - Using platform's existing ProcessingLoader design */
        .loader-page {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .loader-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 0;
        }

        /* Three animated dots */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 2rem;
        }

        .typing-indicator span {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #888;
            animation: typing 1.4s infinite;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { 
                transform: translateY(0); 
                opacity: 0.5; 
            }
            30% { 
                transform: translateY(-10px); 
                opacity: 1; 
            }
        }

        /* Steps container */
        .steps {
            width: 100%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 4px 8px;
            transition: all 0.5s ease;
            transform-origin: left center;
        }

        .step.active {
            transform: scale(1.05);
        }

        .step-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checkmark {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #888;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: scaleIn 0.3s ease;
        }

        @keyframes scaleIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }

        .pulse-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e7e7e7;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { 
                opacity: 0.6; 
                transform: scale(1); 
            }
            50% { 
                opacity: 1; 
                transform: scale(1.2); 
            }
        }

        .step-text {
            font-size: 0.9rem;
            transition: all 0.5s;
        }

        .step-text.completed {
            color: #666;
        }

        .step-text.active {
            color: #e7e7e7;
            font-weight: 500;
        }

        .step-text.pending {
            color: #444;
        }

        /* Chat Page */
        .chat-page {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .chat-container {
            background: #151515;
            border: 1px solid #1a1a1a;
            border-radius: 12px;
            padding: 2rem;
        }

        .message {
            margin-bottom: 1.5rem;
            padding: 1.25rem;
            border-radius: 8px;
            animation: slideIn 0.5s ease-out;
        }

        .message.user {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
        }

        .message.assistant {
            background: #151515;
            border: 1px solid #1a1a1a;
        }

        .message-label {
            font-weight: 500;
            margin-bottom: 0.75rem;
            color: #e7e7e7;
            font-size: 0.9rem;
        }

        .message-text {
            color: #888;
            line-height: 1.6;
        }

        .new-question-btn {
            width: 100%;
            padding: 1rem;
            background: transparent;
            border: 1px solid #1a1a1a;
            border-radius: 8px;
            color: #e7e7e7;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            margin-top: 1rem;
            transition: all 0.2s ease;
        }

        .new-question-btn:hover {
            background: #151515;
            border-color: #2a2a2a;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Landing Page -->
        <div class="landing-page" id="landingPage">
            <h1>Välkommen!</h1>
            <p>Ställ din fråga till vår AI-assistent</p>
            <div class="input-container">
                <input type="text" id="questionInput" placeholder="Skriv din fråga här..." />
                <button onclick="startProcessing()">Skicka fråga</button>
            </div>
        </div>

        <!-- Loader Page - Based on platform's ProcessingLoader -->
        <div class="loader-page" id="loaderPage">
            <div class="loader-container">
                <!-- Three animated dots -->
                <div class="typing-indicator">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>

                <!-- Processing steps -->
                <div class="steps" id="steps">
                    <!-- Steps will be inserted by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Chat Page -->
        <div class="chat-page" id="chatPage">
            <div class="chat-container">
                <div class="message user">
                    <div class="message-label">Du</div>
                    <div class="message-text" id="userQuestion"></div>
                </div>
                <div class="message assistant">
                    <div class="message-label">AI-assistent</div>
                    <div class="message-text" id="assistantResponse"></div>
                </div>
                <button class="new-question-btn" onclick="resetDemo()">Ställ ny fråga</button>
            </div>
        </div>
    </div>

    <script>
        let currentQuestion = '';

        // NLP processing steps matching platform's analysis pipeline
        const steps = [
            'Tokenisering',
            'Entitetsigenkänning',
            'Sentimentanalys',
            'Semantisk analys',
            'Sammanfattning'
        ];

        let currentStep = 0;
        const stepsContainer = document.getElementById('steps');

        function startProcessing() {
            const input = document.getElementById('questionInput');
            currentQuestion = input.value.trim();
            
            if (!currentQuestion) {
                alert('Vänligen skriv en fråga först!');
                return;
            }

            // Hide landing page and show loader
            document.getElementById('landingPage').classList.add('hidden');
            document.getElementById('loaderPage').style.display = 'block';

            // Initialize steps
            initSteps();
            
            // Start processing sequence
            processSteps();
        }

        function initSteps() {
            stepsContainer.innerHTML = '';
            currentStep = 0;

            // Create step elements
            steps.forEach((stepText, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'step';
                stepDiv.id = `step-${index}`;
                stepDiv.innerHTML = `
                    <div class="step-icon" id="icon-${index}"></div>
                    <p class="step-text pending" id="text-${index}">${stepText}</p>
                `;
                stepsContainer.appendChild(stepDiv);
            });
        }

        function processSteps() {
            updateStep();
        }

        function updateStep() {
            if (currentStep >= steps.length) {
                // All steps complete, show chat
                setTimeout(showChat, 500);
                return;
            }

            const stepDiv = document.getElementById(`step-${currentStep}`);
            const iconDiv = document.getElementById(`icon-${currentStep}`);
            const textDiv = document.getElementById(`text-${currentStep}`);

            // Activate current step
            stepDiv.classList.add('active');
            iconDiv.innerHTML = '<div class="pulse-dot"></div>';
            textDiv.className = 'step-text active';

            // After 1.5 seconds, mark as complete and move to next
            setTimeout(() => {
                stepDiv.classList.remove('active');
                iconDiv.innerHTML = `
                    <div class="checkmark">
                        <svg width="16" height="16" fill="white" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                    </div>
                `;
                textDiv.className = 'step-text completed';

                currentStep++;
                updateStep();
            }, 1500);
        }

        function showChat() {
            document.getElementById('loaderPage').style.display = 'none';
            document.getElementById('chatPage').style.display = 'block';
            
            document.getElementById('userQuestion').textContent = currentQuestion;
            
            // Simulate AI response
            const responses = [
                'Det är en intressant fråga! Baserat på min analys kan jag säga att detta är ett komplext ämne som kräver noggrann övervägning av flera faktorer.',
                'Tack för din fråga! Jag har analyserat den och här är min bedömning: Detta beror på olika perspektiv och sammanhang.',
                'Utifrån den information jag har tillgång till kan jag ge följande svar: Det finns flera aspekter att ta hänsyn till när man överväger denna fråga.',
            ];
            
            document.getElementById('assistantResponse').textContent = 
                responses[Math.floor(Math.random() * responses.length)];
        }

        function resetDemo() {
            document.getElementById('chatPage').style.display = 'none';
            document.getElementById('landingPage').classList.remove('hidden');
            document.getElementById('questionInput').value = '';
            currentQuestion = '';
        }

        // Allow Enter key to submit
        document.getElementById('questionInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                startProcessing();
            }
        });
    </script>
</body>
</html>
